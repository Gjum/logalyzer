#!/bin/bash
# scans all unscanned logfiles, i.e. *.log.gz and latest.log

# arguments
slotsec=3600 # 3600 seconds/hour, 86400 seconds/day
if [ -n "$1" ]; then slotsec="$1"; fi

source utils

# scan all compressed logfiles
for logfile in $logfilespath/*.log.gz; do
	scanfile="`echo "$logfile" | sed "s/.log.gz$/$suffix/g"`"
	if [ ! -f $scanfile ]; then
		./scan-one "$logfile" "$slotsec" > "$logfilespath/$scanfile"
	fi
done

# if present, scan latest.log
if [ -f "$logfilespath/latest.log" ]; then
	./scan-one "$logfilespath/latest.log" "$slotsec" > "$logfilespath/latest$suffix"
fi

exit 0

